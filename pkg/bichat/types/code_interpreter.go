package types

import (
	"time"

	"github.com/google/uuid"
)

// CodeInterpreterResult represents the result of a code interpreter execution.
type CodeInterpreterResult struct {
	// ID is a unique identifier for this execution
	ID string `json:"id"`

	// Code is the Python code that was executed
	Code string `json:"code"`

	// ContainerID is the container ID where code ran
	ContainerID string `json:"container_id"`

	// Status indicates execution status ("completed", "failed")
	Status string `json:"status"`

	// Logs contains stdout/stderr output
	Logs string `json:"logs"`

	// Outputs contains structured outputs returned by code interpreter runtime.
	Outputs []CodeInterpreterGeneratedOutput `json:"outputs,omitempty"`
}

// CodeInterpreterGeneratedOutput represents a single output from a code interpreter call.
type CodeInterpreterGeneratedOutput struct {
	Type string `json:"type"`
	URL  string `json:"url,omitempty"`
	Logs string `json:"logs,omitempty"`
}

// FileAnnotation represents a file generated by code interpreter.
type FileAnnotation struct {
	// Type is the annotation type (e.g., "container_file_citation")
	Type string `json:"type"`

	// ContainerID is the container ID
	ContainerID string `json:"container_id"`

	// FileID is the file ID in provider storage
	FileID string `json:"file_id"`

	// Filename is the original filename
	Filename string `json:"filename"`

	// StartIndex is the start position in content
	StartIndex int `json:"start_index"`

	// EndIndex is the end position in content
	EndIndex int `json:"end_index"`
}

// CodeInterpreterOutput represents a file generated by code interpreter execution.
// These files are downloaded from the LLM provider and stored locally.
type CodeInterpreterOutput struct {
	// ID is the unique identifier for this output
	ID uuid.UUID `json:"id"`

	// MessageID is the foreign key to the message that generated this output
	MessageID uuid.UUID `json:"message_id"`

	// Name is the filename (e.g., "chart.png", "data.csv")
	Name string `json:"name"`

	// MimeType is the MIME type (e.g., "image/png", "text/csv")
	MimeType string `json:"mime_type"`

	// URL is the public download URL
	URL string `json:"url"`

	// Size is the file size in bytes
	Size int64 `json:"size"`

	// CreatedAt is when the output was created
	CreatedAt time.Time `json:"created_at"`
}
